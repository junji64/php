<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type">
    <title>PHP Secure E-mail</title>
    <style>a.menu_php_secure_mail{font-weight:bold;}</style>
    <style>
#smallnavContainer {display:none;}
</style> <meta name="viewport" content="width=device-width">
    <meta name="Keywords" content="HTML,CSS,XML,JavaScript,DOM,jQuery,ASP.NET,PHP,SQL,colors,tutorial,programming,development,training,learning,quiz,primer,lessons,reference,examples,source code,demos,tips,color table,w3c,cascading style sheets,active server pages,Web building,Webmaster">
    <meta name="Description" content="Free HTML CSS JavaScript DOM jQuery XML AJAX RSS ASP .NET PHP SQL tutorials, references, examples for web building.">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-3855518-1']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script> <script type="text/javascript">
var googletag = googletag || {};
googletag.cmd = googletag.cmd || [];
(function() {
var gads = document.createElement('script');
gads.async = true;
gads.type = 'text/javascript';
var useSSL = 'https:' == document.location.protocol;
gads.src = (useSSL ? 'https:' : 'http:') + 
'//www.googletagservices.com/tag/js/gpt.js';
var node = document.getElementsByTagName('script')[0];
node.parentNode.insertBefore(gads, node);
})();
</script> <script type="text/javascript">
googletag.cmd.push(function() {
googletag.defineSlot('/16833175/BottomMediumRectangle', [300, 250], 'div-gpt-ad-1403595829794-0').addService(googletag.pubads());
googletag.defineSlot('/16833175/LargePS', [[723, 280], [723, 400], [728, 280], [728, 400], [728, 450]], 'div-gpt-ad-1403595829794-1').addService(googletag.pubads());
googletag.defineSlot('/16833175/MainLeaderboard', [728, 90], 'div-gpt-ad-1403595829794-2').addService(googletag.pubads());
googletag.defineSlot('/16833175/SmallPS', [[723, 170], [728, 170]], 'div-gpt-ad-1403595829794-4').addService(googletag.pubads());
var adScreenWidth = screen.width;
if (adScreenWidth <= 768) {   
  googletag.defineSlot('/16833175/MobileBottomBanner', [728, 90], 'div-gpt-ad-1403595829794-3').addService(googletag.pubads());
} else { 
  googletag.defineSlot('/16833175/WideSkyScraper', [160, 600], 'div-gpt-ad-1403595829794-5').addService(googletag.pubads());
}
googletag.pubads().setTargeting("content","php");
googletag.pubads().enableSingleRequest();
googletag.enableServices();
});
</script> <link rel="stylesheet" type="text/css" href="http://www.w3schools.com/stdtheme.css">
  </head>
  <body>
    <div id="smallnavContainer">
      <div id="smallnav">
        <div id="menuDIV">
          <hr>
          <hr>
          <hr></div>
        <div id="closeSearchBTN" onclick="hideSearch()">X</div>
        <a href="/default.asp"> </a></div>
    </div>
    <div id="belowTopnav" style="width:auto">
      <div id="page" style="width:auto; padding:30px; margin:10px;">
        <div>
          <div id="main" style="width:auto">
            <h1>PHP <span class="color_h1">Secure E-mails</span></h1>
            <div class="chapter">
              <div class="prev"><a class="chapter" href="PHP%20mail%28%29%20Function.html">«
                  Previous</a></div>
              <div class="next"><a class="chapter" href="PHP%20Error%20Handling.html">Next
                  Chapter »</a></div>
            </div>
            <hr>
            <p class="intro">이전 장에서 PHP e-mail 스크립트의 약점을 살펴보았다.&nbsp;</p>
            <hr>
            <h2>PHP Stopping E-mail Injections</h2>
            <p>e-mail 주입을 방지하는 최선의 반법은 입력의 윻성 검사이다.&nbsp;</p>
            <p>아래의 코드는 이전 장의 것과 동일하지만, 이제는 폼 안에"from" 필드를 검사하는 입력 유효성 검사를 추가하였다.
              :</p>
            <div class="code notranslate">
              <div> &lt;html&gt;<br>
                &lt;body&gt;<br>
                &lt;?php<br>
                function spamcheck($field) {<br>
                &nbsp;&nbsp;// Sanitize e-mail address<br>
                &nbsp;&nbsp;$field=filter_var($field, FILTER_SANITIZE_EMAIL);<br>
                &nbsp;&nbsp;// Validate e-mail address<br>
                &nbsp;&nbsp;if(filter_var($field, FILTER_VALIDATE_EMAIL))&nbsp;{<br>
                &nbsp;&nbsp;&nbsp;&nbsp;return TRUE;<br>
                &nbsp;&nbsp;} else {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;return FALSE;<br>
                &nbsp;&nbsp;}<br>
                }<br>
                ?&gt;<br>
                <br>
                &lt;h2&gt;Feedback Form&lt;/h2&gt;<br>
                &lt;?php<br>
                // display form if user has not clicked submit<br>
                if (!isset($_POST["submit"])) {<br>
                &nbsp; ?&gt;<br>
                &nbsp; &lt;form method="post" action="&lt;?php echo
                $_SERVER["PHP_SELF"];?&gt;"&gt;<br>
                &nbsp; From: &lt;input type="text" name="from"&gt;&lt;br&gt;<br>
                &nbsp; Subject: &lt;input type="text"
                name="subject"&gt;&lt;br&gt;<br>
                &nbsp; Message: &lt;textarea rows="10" cols="40"
                name="message"&gt;&lt;/textarea&gt;&lt;br&gt;<br>
                &nbsp; &lt;input type="submit" name="submit" value="Submit
                Feedback"&gt;<br>
                &nbsp; &lt;/form&gt;<br>
                &nbsp; &lt;?php <br>
                } else&nbsp;{&nbsp; // the user has submitted the form<br>
                &nbsp; // Check if the "from" input field is filled out<br>
                &nbsp; if (isset($_POST["from"])) {<br>
                &nbsp;&nbsp;&nbsp; // Check if "from" email address is valid<br>
                &nbsp; &nbsp;&nbsp;$mailcheck = spamcheck($_POST["from"]);<br>
                &nbsp;&nbsp;&nbsp; if ($mailcheck==FALSE) {<br>
                &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;echo "Invalid input";<br>
                &nbsp;&nbsp;&nbsp; }&nbsp;else {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $from = $_POST["from"]; // sender<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $subject = $_POST["subject"];<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $message = $_POST["message"];<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // message lines should not
                exceed 70 characters (PHP rule), so wrap it<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $message = wordwrap($message,
                70);<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // send mail<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                mail("webmaster@example.com",$subject,$message,"From: $from\n");<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo "Thank you for sending us
                feedback";<br>
                &nbsp;&nbsp;&nbsp; }<br>
                &nbsp; }<br>
                }<br>
                ?&gt;<br>
                &lt;/body&gt;<br>
                &lt;/html&gt;</div>
            </div>
            <p>위의 코드에서 우리는 PHP 필터를 사용하며 입력 유효성 검사를 수행한다. :</p>
            <ul>
              <li>FILTER_SANITIZE_EMAIL 필터는 문자열에서 모든 불법 이메일 문자를 제거한다.</li>
              <li>FILTER_VALIDATE_EMAIL 필터는 이메일 주소로서의 값의 유효성 검사를 한다.&nbsp;</li>
            </ul>
            <p>You can read more about filters in our <a href="php_filter.asp">PHP
                Filter</a> chapter.</p>
            <br>
            <div class="chapter">
              <div class="prev"><a class="chapter" href="PHP%20mail%28%29%20Function.html">«
                  Previous</a></div>
              <div class="next"><a class="chapter" href="PHP%20Error%20Handling.html">Next
                  Chapter »</a></div>
            </div>
            <hr> </div>
        </div>
      </div>
      <br>
    </div>
  </body>
</html>
