<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type">
    <title>23. File Upload</title>
    <style>a.menu_html_intro{font-weight:bold;}</style>
    <meta name="viewport" content="width=device-width">
    <meta name="Keywords" content="HTML,PHP,SQL,tutorial,programming,development,Web building,Webmaster">
    <link rel="stylesheet" href="w3.css">
  </head>
  <body>
    <div id="belowTopnav" style="width:auto">
      <div id="page" style="width:auto; padding:30px; margin:10px;">
        <div>
          <div id="main" style="width:auto">
            <h1>23. <span class="color_h1">File Upload</span></h1>
                        <div class="w3-clear nextprev"> <a class="w3-left w3-btn" href="22.%20File%20Create%20Write.html">«
                Previous</a> <a class="w3-right w3-btn" href="24.%20Cookies.html">Next  »</a> </div>
            <hr>
            <p class="intro">PHP 를 사용해서 파일을 서버에 업로드하는 것이 가능하다.</p>
            <hr>
            <h2>Create an Upload-File Form</h2>
            <p>사용자들이 폼으로 파일을 업로드 할수 있도록 하는 것은 매우 유용할 수 있습니다.&nbsp; </p>
            <p>파일을 업로드하기 위한 다음의 HTML 폼을 보시오:</p>
            <div class="w3-code w3-border   notranslate">
              <div> &lt;html&gt;<br>
                &lt;body&gt;<br>
                <br>
                &lt;form action="upload_file.php" method="post"
                enctype="multipart/form-data"&gt;<br>
                &lt;label for="file"&gt;Filename:&lt;/label&gt;<br>
                &lt;input type="file" name="file" id="file"&gt;&lt;br&gt;<br>
                &lt;input type="submit" name="submit" value="Submit"&gt;<br>
                &lt;/form&gt;<br>
                <br>
                &lt;/body&gt;<br>
                &lt;/html&gt; </div>
            </div>
            <p>위의 HTML form에 대해 다음의 사항들을 주목하시오:</p>
            <ul>
              <li>&lt;form&gt; 태그의 enctype 속성은 폼을 제출할 때 사용할 콘텐츠-형식(content-type)
                을 지정합니다.&nbsp; "multipart/form-data" 는 업로드할 파일의 내용처럼, 폼이 이진데이터를
                요구할 때 사용됩니다. </li>
              <li>&lt;input&gt; 태그의 type="file" 속성은 입력이 파일로 처리됨을 지정합니다.&nbsp; 예를
                들어, 브라우져에서 볼 때, 입력 버튼 다음에 브라우즈-버튼(browse-button)이 온다.&nbsp; </li>
            </ul>
            <p><b>Note:</b> 사용자가 파일을 업로드 하도록 허용하는 것은 큰 보안 위험이 따른다. 신뢰할 수 있는
              사용자에게만 파일 업로드를 허용하십시요.<br>
            </p>
            <hr>
            <h2>Create The Upload Script</h2>
            <p>"upload_file.php" 파일은 파일 업로드를 위한 코드를 포합한다. :</p>
            <div class="w3-code w3-border   notranslate">
              <div> &lt;?php<br>
                if (isset($_FILES)) {<br>
                &nbsp;&nbsp;&nbsp; $file = $_FILES["file"];<br>
                &nbsp;&nbsp;&nbsp; // print_r($file);<br>
                &nbsp;&nbsp;&nbsp; $error = $file["error"];<br>
                &nbsp;&nbsp;&nbsp; $name = $file["name"];<br>
                &nbsp;&nbsp;&nbsp; $type = $file["type"];<br>
                &nbsp;&nbsp;&nbsp; $size = $file["size"];<br>
                &nbsp;&nbsp;&nbsp; $tmp_name = $file["tmp_name"];<br>
                &nbsp;&nbsp;&nbsp; if ( $error &gt; 0 ) {<br>
                &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo "Error: " . $error .
                "&lt;br&gt;";<br>
                &nbsp;&nbsp;&nbsp; }<br>
                &nbsp;&nbsp;&nbsp; else&nbsp;{<br>
                &nbsp; &nbsp;&nbsp;&nbsp; echo "Upload: " . $name .
                "&lt;br&gt;";<br>
                &nbsp; &nbsp;&nbsp;&nbsp; echo "Type: " . $type . "&lt;br&gt;";<br>
                &nbsp; &nbsp;&nbsp;&nbsp; echo "Size: " . ($size/1024/1024) . "
                Mb&lt;br&gt;";<br>
                &nbsp; &nbsp;&nbsp;&nbsp; echo "Stored in: " . $tmp_name;<br>
                &nbsp;&nbsp;&nbsp; }<br>
                }<br>
                else {<br>
                &nbsp;&nbsp;&nbsp; echo "File is not selected";<br>
                }<br>
                ?&gt; </div>
            </div>
            <p>전역 PHP $_FILES 배열을 사용하여, 클라이언트 컴퓨터로부터 원격 서버에 파일을 업로드 할 수
              있습니다.&nbsp;</p>
            <p>첫 번째 파라메터는 폼의 input name 이며, 두 번째 인덱스는 "name", "type", "size",
              "tmp_name" 또는 "error" 중의 하나가 올 수 있다, 다음 처럼 :</p>
            <ul>
              <li>$_FILES["file"]["name"] - the name of the uploaded file</li>
              <li>$_FILES["file"]["type"] - the type of the uploaded file</li>
              <li>$_FILES["file"]["size"] - the size in bytes of the uploaded
                file</li>
              <li>$_FILES["file"]["tmp_name"] - the name of the temporary copy
                of the file stored on the server</li>
              <li>$_FILES["file"]["error"] - the error code resulting from the
                file upload</li>
            </ul>
            <p>이것은 파일을 업로드하는 간단한 방법입니다. 보안상의 이유로 어떤 사용자가 업로드할 수 있는지를 제한하는 것을 추가
              해야 합니다. </p>
            <hr>
            <h2>Restrictions on Upload</h2>
            <p>이 스크립트에서는 파일 업로드에 몇 가지 제한을 추가 합니다. 사용자는 .gif, .jpeg, 과 .png 파일을
              업로드 할 수 있습니다. ; 그리고 파일의 크기는 2 Mb 미만이여야 합니다.:</p>
            <div class="w3-code w3-border   notranslate">
              <div> &lt;?php<br>
                $allowedExts = array("gif", "jpeg", "jpg", "png");<br>
                <br>
                if (isset($_FILES)) {<br>
                &nbsp;&nbsp;&nbsp; $file = $_FILES["file"];<br>
                &nbsp;&nbsp;&nbsp; $error = $file["error"];<br>
                &nbsp;&nbsp;&nbsp; $name = $file["name"];<br>
                &nbsp;&nbsp;&nbsp; $type = $file["type"];<br>
                &nbsp;&nbsp;&nbsp; $size = $file["size"];<br>
                &nbsp;&nbsp;&nbsp; $tmp_name = $file["tmp_name"];<br>
                &nbsp;&nbsp;&nbsp; <br>
                &nbsp;&nbsp;&nbsp; if ( $error &gt; 0 ) {<br>
                &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo "Error: " . $error .
                "&lt;br&gt;";<br>
                &nbsp; &nbsp; } <br>
                &nbsp;&nbsp;&nbsp; else&nbsp;{<br>
                &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $temp = explode(".",
                $name);<br>
                &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; // print_r($temp);<br>
                &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $extension = end($temp);<br>
                &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; //echo $extension;<br>
                &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br>
                &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if ( ($size/1024/1024)
                &lt; 2.) &amp;&amp; in_array($extension, $allowedExts) )&nbsp;{<br>
                &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo
                "Upload: " . $name . "&lt;br&gt;";<br>
                &nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; echo "Type:
                " . $type . "&lt;br&gt;";<br>
                &nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; echo "Size:
                " . ($size/1024/1024) . " Mb&lt;br&gt;";<br>
                &nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; echo "Stored
                in: " . $tmp_name;<br>
                &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; }<br>
                &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; else&nbsp;{<br>
                &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;&nbsp; echo
                ($size/1024/1024) . " Mbyte is bigger than 2 Mb ";<br>
                &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo
                $extension . "format file is not allowed to upload ! ";<br>
                &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br>
                &nbsp;&nbsp;&nbsp; } <br>
                }<br>
                else {<br>
                &nbsp;&nbsp;&nbsp; echo "File is not selected";<br>
                }<br>
                ?&gt; </div>
            </div>
            <br>
            <hr>
            <h2>Saving the Uploaded File</h2>
            <p>위의 예제는 서버의 PHP temp 폴더에 업로드된 파일들의 임시 복사본을 생성합니다. </p>
            <p>임시 복사본 파일들은 스크립트가 종료될 때 사라집니다. 업로드된 파일들을 저장하기 위해서는 다른 장소로 복사할 필요가
              있습니다. :</p>
            <div class="w3-code w3-border   notranslate">
              <div> &lt;?php<br>
                $allowedExts = array("gif", "jpeg", "jpg", "png");<br>
                <br>
                if (isset($_FILES)) {<br>
                &nbsp;&nbsp;&nbsp; $file = $_FILES["file"];<br>
                &nbsp;&nbsp;&nbsp; $error = $file["error"];<br>
                &nbsp;&nbsp;&nbsp; $name = $file["name"];<br>
                &nbsp;&nbsp;&nbsp; $type = $file["type"];<br>
                &nbsp;&nbsp;&nbsp; $size = $file["size"];<br>
                &nbsp;&nbsp;&nbsp; $tmp_name = $file["tmp_name"];<br>
                &nbsp;&nbsp;&nbsp; <br>
                &nbsp;&nbsp;&nbsp; if ( $error &gt; 0 ) {<br>
                &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo "Error: " . $error .
                "&lt;br&gt;";<br>
                &nbsp; &nbsp; } <br>
                &nbsp;&nbsp;&nbsp; else&nbsp;{<br>
                &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $temp = explode(".",
                $name);<br>
                &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $extension = end($temp);<br>
                &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br>
                &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if ( ($size/1024/1024)
                &lt; 2. && in_array($extension, $allowedExts) )&nbsp;{<br>
                &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; //echo
                "Upload: " . $name . "&lt;br&gt;";<br>
                &nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //echo
                "Type: " . $type . "&lt;br&gt;";<br>
                &nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; //echo
                "Size: " . ($size / 1024 / 1024) . " Mb&lt;br&gt;";<br>
                &nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; //echo
                "Stored in: " . $tmp_name;<br>
                &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if
                (file_exists("upload/" . $name))&nbsp;{<br>
                &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                &nbsp;&nbsp;&nbsp; echo $name . " already exists. ";<br>
                &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; } <br>
                &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                else&nbsp;{<br>
                &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                &nbsp;&nbsp;&nbsp; move_uploaded_file($tmp_name, "upload/" .
                $name);<br>
                &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                &nbsp;&nbsp;&nbsp; echo "Stored in: " . "upload/" . $name;<br>
                &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br>
                &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; }<br>
                &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; else&nbsp;{<br>
                &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;&nbsp; echo
                ($size/1024/1024) . " Mbyte is bigger than 2 Mb ";<br>
                &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo
                $extension . "format file is not allowed to upload ! ";<br>
                &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br>
                &nbsp;&nbsp;&nbsp; } <br>
                }<br>
                else {<br>
                &nbsp;&nbsp;&nbsp; echo "File is not selected";<br>
                }<br>
                ?&gt; <br>
              </div>
            </div>
            <p>위의 스크립트는 파일이 이미 존재 하는지 검사하여, 존재하지 않으면, "upload" 라고 하는 폴더에 파일을 복사
              합니다.</p>
            <br>
                         <div class="w3-clear nextprev"> <a class="w3-left w3-btn" href="22.%20File%20Create%20Write.html">«
                Previous</a> <a class="w3-right w3-btn" href="24.%20Cookies.html">Next  »</a> </div>
            <hr> </div>
        </div>
      </div>
      <br>
    </div>
  </body>
</html>
