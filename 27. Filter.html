<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type">
    <title>27. Filter</title>
    <style>a.menu_html_intro{font-weight:bold;}</style>
    <meta name="viewport" content="width=device-width">
    <meta name="Keywords" content="HTML,PHP,SQL,tutorial,programming,development,Web building,Webmaster">
    <link rel="stylesheet" href="w3.css">
  </head>
  <body>
    <div id="belowTopnav" style="width:auto">
      <div id="page" style="width:auto; padding:30px; margin:10px;">
        <div>
          <div id="main" style="width:auto">
            <h1>27. <span class="color_h1">Filter</span></h1>
            <div class="w3-clear nextprev"> <a class="w3-left w3-btn" href="26.%20Sessions.html">«
                Previous</a> <a class="w3-right w3-btn" href="index.html">Next  »</a> </div>
            <hr>
            <p class="intro">PHP 필터는 사용자 입력과 같은 안전하지 않은 소스로부터의 데이타를 유효성 검사하여
              필터링하는데 사용된다. </p>
            <hr>
            <h2>What is a PHP Filter? </h2>
            <p>PHP filter 는 안전하지 않은 소스로부터의 데이타를 유효성 검사하여 필터링하는데 사용된다.</p>
            <p>입력 또는 사용자 정의 데이타를 시험하고, 유효성 검사하고, 필터링하는 것은 웹프로그래밍의 중요한
              부분이다.&nbsp;</p>
            <p>PHP filter 확장은 데이타 필터링을 더 쉽고 빠르게 할 수 있도록 설계되었습니다.</p>
            <hr>
            <h2>Why use a Filter?</h2>
            <p>거의 모든 웹 응용 프로그램은 외부 입력에 의존한다. 일반적으로 이는 사용자나 또 다른 응용 프로그램(웹서비스와
              같은)으로 부터 온다. 필터를 사용하여 당신의 응용 프로그램이 정확한 입력 형식을 얻게 됨을 확신할 수
              있다.&nbsp;</p>
            <p><b>모든 외부 데이타는 항상 필러링해야만 한다 !</b></p>
            <p>입력 필터링은 가장 중요한 에플리케이션 보안 이슈 중의 하나이다.&nbsp;</p>
            <p>외부 데이터란?</p>
            <ul>
              <li>폼으로부터의 입력 데이타</li>
              <li>Cookies</li>
              <li>웹서비스 데이타</li>
              <li>서버 변수</li>
              <li>데이타베이스 쿼리 결과 </li>
            </ul>
            <hr>
            <h2>Functions and Filters</h2>
            <p>변수를 필터링하기 위해서, 다음 필터링 함수들 중의 하나를 사용한다.:</p>
            <ul>
              <li>filter_var() - 지정된 필터로 <strong>하나의 변수</strong>를 필터링</li>
              <li>filter_var_array() - 동일한 또는 서로 다른 필터로 <strong>여러 변수</strong>를
                필터링. </li>
              <li>filter_input() - <strong>하나의 입력변수</strong>를 가져와서 필터링</li>
              <li>filter_input_array() - <strong>여러 입력변수</strong>를 가져와서 동일한 또는
                서로 다른 필터로 필터링</li>
            </ul>
            <p>아래의 예에서, filter_var() 함수를 사용하여 <strong>정수의 유효성검사</strong>를 한다. :</p>
            <div class="w3-code w3-border  notranslate">
              <div> &lt;?php<br>
                $int = 123;<br>
                <br>
                if(!filter_var($int, FILTER_VALIDATE_INT))&nbsp;{<br>
                &nbsp;&nbsp;echo("Integer is not valid");<br>
                } else&nbsp;{<br>
                &nbsp;&nbsp;echo("Integer is valid");<br>
                }<br>
                ?&gt; </div>
            </div>
            <p>위의 코드는 변수를 필터링 하는데&nbsp; "FILTER_VALIDATE_INT"&nbsp; 필터를 사용합니다.
              정수가 유효하므로, 위 코드의 출력은 다음과 같다 : "Integer is valid".</p>
            <p>만약 정수가 아닌 변수("123abc" 처럼)를 시도한다면, 출력은 다음과 같을 것이다. "Integer is not
              valid".</p>
            <p>함수와 필터의 전쳬 목록을 보려면 <a href="http://www.w3schools.com/php/php_ref_filter.asp">PHP
                Filter Reference</a> 를 방문하시오.<br>
            </p>
            <hr>
            <h2>Validating and Sanitizing</h2>
            <p>필터에는 두가지 종류가 있다:</p>
            <p>유효성검사(Validating) 필터:</p>
            <ul>
              <li>사용자 입력의 유효성 검사에 사용</li>
              <li>엄격한 형식 규칙 (URL 또는 E-Mail 유효성 검사 같은)</li>
              <li>성공시 예상 유형(expected type)을 또는 실패시 FALSE 를 반환한다. </li>
            </ul>
            <p>위생/살균(Sanitizing) 필터:</p>
            <ul>
              <li>문자열에서 지정한 문자들을 허용 또는 거부하는데 사용됩니다</li>
              <li>데이터 형식 규칙이 없다.</li>
              <li>항상 문자열을 반환한다.&nbsp;</li>
            </ul>
            <hr>
            <h2>Options and Flags</h2>
            <p>지정된 필터에 추가적인 옵션을 추가하는데 옵션과 플래그가(Options and flags) 사용됩니다.&nbsp; </p>
            <p>다른 필터는 다른 옵션과 플래그를 갖는다.&nbsp; </p>
            <p>아래의 예에서, filter_var() 을 이용해서 "min_range" 와 "max_range" 옵션으로 정수의
              유효성 검사를 수행한다. :</p>
            <div class="w3-code w3-border  notranslate">
              <div> &lt;?php<br>
                $var=300;<br>
                <br>
                $int_options = array(<br>
                "options"=&gt;array<br>
                &nbsp;&nbsp;(<br>
                &nbsp;&nbsp;"min_range"=&gt;0,<br>
                &nbsp;&nbsp;"max_range"=&gt;256<br>
                &nbsp;&nbsp;)<br>
                );<br>
                <br>
                if(!filter_var($var, FILTER_VALIDATE_INT, $int_options))&nbsp;{<br>
                &nbsp;&nbsp;echo("Integer is not valid");<br>
                } else&nbsp;{<br>
                &nbsp;&nbsp;echo("Integer is valid");<br>
                }<br>
                ?&gt; </div>
            </div>
            <p>위의 코드와 카찬가지로, 옵션은 "options" 이라는 이름으로 연관 배열(associative array)에
              놓여야 한다. 플래그가 사용될 경우에는 배열에 놓일 필요는 없다.</p>
            <p>정수 "300" 은 지정한 범위에 있지 않으므로, 위의 코드는 출력은 다음과 같다. "Integer is not
              valid".</p>
            <p>함수와 필터의 전쳬 목록을 보려면&nbsp; <a href="http://www.w3schools.com/php/php_ref_filter.asp">PHP
                Filter Reference</a> 를 방문하시오. </p>
            <hr>
            <h2>Validate Input</h2>
            <p>폼으로부터의 입력의 유효성 검사를 해보자.&nbsp;</p>
            <p>해야할 첫번째 일은, 우리가 찾고 있는 입력자료를 확인하는 것이다. </p>
            <p>다음에는, 입력 데이타를 filter_input() 함수로 필터링 한다. </p>
            <p>아래의 예에서, 입력 변수 "email" 은 PHP 페이지로 보내진다 :</p>
            <div class="w3-code w3-border  notranslate">
              <div> &lt;?php<br>
                if(!filter_has_var(INPUT_GET, "email"))&nbsp;{<br>
                &nbsp;&nbsp;echo("Input type does not exist");<br>
                } else&nbsp;{<br>
                &nbsp;&nbsp;if (!filter_input(INPUT_GET, "email",
                FILTER_VALIDATE_EMAIL))&nbsp;{<br>
                &nbsp;&nbsp;&nbsp;&nbsp;echo "E-Mail is not valid";<br>
                &nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
                &nbsp;&nbsp;&nbsp;&nbsp;echo "E-Mail is valid";<br>
                &nbsp;&nbsp;}<br>
                }<br>
                ?&gt; </div>
            </div>
            <h2>Example Explained</h2>
            <p>위의 예는 "GET" method를 사용하여 입력(email)을 보낸다.:</p>
            <ol>
              <li>"GET" 타입의 입력변수 "email" 가 있는 지를 확인한다.&nbsp; </li>
              <li>입력 변수가 존재하면, 그것이 유효한&nbsp; e-mail address 인 지를 확인한다. </li>
            </ol>
            <hr>
            <h2>Sanitize Input</h2>
            <p>폼으로부터 보내진 URL 정리를 시도해보자.&nbsp;</p>
            <p>먼저, 우리가 찾고있는 입력 데이타가 있는 지를 확인한다. .</p>
            <p>다음, filter_input() 함수로 입력 데이타를 제균(sanitize)한다.</p>
            <p>아래의 예에서, 입력변수 "url" 은 PHP 페이지로 보내진다.:</p>
            <div class="w3-code w3-border  notranslate">
              <div> &lt;?php<br>
                if(!filter_has_var(INPUT_POST, "url"))&nbsp;{<br>
                &nbsp;&nbsp;echo("Input type does not exist");<br>
                } else&nbsp;{<br>
                &nbsp;&nbsp;$url = filter_input(INPUT_POST, <br>
                &nbsp;&nbsp;"url", FILTER_SANITIZE_URL);<br>
                }<br>
                ?&gt; </div>
            </div>
            <h2>Example Explained</h2>
            <p>위의 예는&nbsp; "POST" method 를 사용하여 보내지는 입력 url 을 가진다.:</p>
            <ol>
              <li>"POST" 타입의 "url" 입력이 존재하는 지를 확인한다.</li>
              <li>입력변수가 존재하면, 제균(sanitize) (잘못된 문자를 버리는) 하고&nbsp; $url 변수에 저장을
                한다.</li>
            </ol>
            <p>입력 변수가 "http://www.W3ååSchøøools.com/" 과 같은 문자열이라면, 제균된
              $url&nbsp; 변수는 다음과 같이 표시된다. :</p>
            <div class="w3-code w3-border  notranslate">
              <div> http://www.W3Schools.com/ </div>
            </div>
            <br>
            <hr>
            <h2>Filter Multiple Inputs</h2>
            <p>폼은 대부분 하나 이상의 입력 필드로 구성된다.&nbsp; filter_var 또는 filter_input 함수를
              반복해서 호출하는 것을 피하기 위해서, 우리는 filter_var_array 또는 filter_input_array
              함수를 사용할 수 있다.</p>
            <p>이 예에서 우리는 3개의 GET 변수를 필터링하는데 filter_input_array() 함수를 사용한다. 받은
              GET 변수는 name, age 그리고 e-mail address 이다.:</p>
            <div class="w3-code w3-border  notranslate">
              <div> &lt;form method="GET" action="&lt;?php echo
                $_SERVER['PHP_SELF']?&gt;"&gt;<br>
                Name : &lt;input type="text" name="name"&gt;&lt;br&gt;<br>
                Age: &lt;input type="text" name="age"&gt;&lt;br&gt;<br>
                Email: &lt;input type="text" name="email"&gt;&lt;br&gt;<br>
                &lt;input type="submit" name="submit" value="Submit"&gt;<br>
                &lt;/form&gt;<br>
                <br>
                &lt;?php<br>
                $filters = array<br>
                &nbsp;&nbsp;(<br>
                &nbsp;&nbsp;"name" =&gt; array<br>
                &nbsp;&nbsp;&nbsp;&nbsp;(<br>
                &nbsp;&nbsp;&nbsp;&nbsp;"filter"=&gt;FILTER_SANITIZE_STRING<br>
                &nbsp;&nbsp;&nbsp;&nbsp;),<br>
                &nbsp;&nbsp;"age" =&gt; array<br>
                &nbsp;&nbsp;&nbsp;&nbsp;(<br>
                &nbsp;&nbsp;&nbsp;&nbsp;"filter"=&gt;FILTER_VALIDATE_INT,<br>
                &nbsp;&nbsp;&nbsp;&nbsp;"options"=&gt;array<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"min_range"=&gt;1,<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"max_range"=&gt;120<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>
                &nbsp;&nbsp;&nbsp;&nbsp;),<br>
                &nbsp;&nbsp;"email"=&gt; FILTER_VALIDATE_EMAIL<br>
                &nbsp;&nbsp;);<br>
                <br>
                $result = filter_input_array(INPUT_GET, $filters);<br>
                <br>
                if (!$result["age"])&nbsp;{<br>
                &nbsp;&nbsp;echo("Age must be a number between 1 and
                120.&lt;br&gt;");<br>
                } elseif(!$result["email"])&nbsp;{<br>
                &nbsp;&nbsp;echo("E-Mail is not valid.&lt;br&gt;");<br>
                } else&nbsp;{<br>
                &nbsp;&nbsp;echo("User input is valid");<br>
                }<br>
                ?&gt; </div>
            </div>
            <h2>Example Explained</h2>
            <p>위의 예는 "GET" method를 사용하여 보내지는 3개의 입력(name, age and email)이 있습니다.
              :</p>
            <ol>
              <li>입력 변수들의 이름과 지정된 입력변수에 사용될 필터들을 포함하는 배열을 설정</li>
              <li> GET 입력변수와 설정한 배열과 함께 filter_input_array() 함수를 호출</li>
              <li>잘못된 입력여부를 $result 변수에 있는 "age" 와 "email" 변수에서 확인 (어떤 입력변수가
                유효하지 않더라도, filter_input_array() 함수로 부터 입력변수는 FALSE 가 된다.)</li>
            </ol>
            <p>filter_input_array() 함수의 두번째 파라메타는 배열 또는 단일 필터 ID 가 될 수 있다..</p>
            <p>파라메타가 단일 필터 ID 라면, 입력 배열의 모든 값들은 지정된 필터로 필터링 된다. </p>
            <p>파라메타가 배열이라면, 다음의 규칙을 따라야만한다.:</p>
            <ul>
              <li>배열의 키(key)로서 ("age" 입력변수처럼) 입력변수를 포함하는 연관배열이어야
                합니다.&nbsp;&nbsp; </li>
              <li>배열 값은 필터 ID 이거나 배열지정된 필터, 플래그, 와 옵션을 지정하는 배열이어야 한다.</li>
            </ul>
            <hr>
            <h2>Using Filter Callback</h2>
            <p>FILTER_CALLBACK 필터를 사용하여, 사용자 정의 함수를 호출하여 필터로 사용하는 것이 가능하다. 이
              방법으로 데이타 필터링을 완전히 제어할 수 있게 해준다.&nbsp;</p>
            <p>당신 자신이 정의한 함수를 만들 수도 있고, 기존의&nbsp; PHP 함수를 사용할 수도 있습니다. </p>
            <p>필터링에 사용하기를 원하는 함수를 옵션을 지정한 것과 같이 지정한다.&nbsp; 연관 배열에 "options"이라는
              이름을 갖는다. </p>
            <p>아래의 예에서, 모든 "_" 를 공백으로 변환하는 사용자 생성 함수를 사용한다.:</p>
            <div class="w3-code w3-border  notranslate">
              <div> &lt;?php<br>
                function convertSpace($string) {<br>
                &nbsp; return str_replace("_", " ", $string);<br>
                }<br>
                <br>
                $string = "Peter_is_a_great_guy!";<br>
                <br>
                echo filter_var($string, FILTER_CALLBACK,<br>
                array("options"=&gt;"convertSpace"));<br>
                ?&gt; </div>
            </div>
            <p>위 코드의 결과는 다음과 같아야 한다 :</p>
            <div class="w3-code w3-border  notranslate">
              <div> Peter is a great guy! </div>
            </div>
            <h2>Example Explained</h2>
            <p>위의 예제에서는 모든 "_" 를 공백으로 변환한다.:</p>
            <ol>
              <li>&nbsp;"_" 를 공백으로 변환한 함수를 생성한다.&nbsp;</li>
              <li>FILTER_CALLBACK 필터와 함수를 담고 있는 배열과 함께, filter_var() 함수를
                호출한다.&nbsp;</li>
            </ol>
            <br>
            <div class="w3-clear nextprev"> <a class="w3-left w3-btn" href="26.%20Sessions.html">«
                Previous</a> <a class="w3-right w3-btn" href="index.html">Next  »</a> </div>
            <hr> </div>
        </div>
      </div>
      <br>
    </div>
  </body>
</html>
